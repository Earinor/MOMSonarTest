„B
Mc:\Users\jafu\Source\Repos\NewRepo\MSMQTutorial\MSMQTutorialServer\Program.cs
	namespace 	
MSMQTutorialServer
 
{ 
internal 
class 
Program 
{		 
private 
static 
string 
path "
=# $
$str% 9
;9 :
private 
static 
string 
description )
=* +
$str, G
;G H
private 
static 
void 
Main  
(  !
string! '
[' (
]( )
args* .
). /
{ 	
MessageQueue 
publicQueue $
=% &
null' +
;+ ,
List 
< 
string 
> 
users 
=  
new! $
List% )
<) *
string* 0
>0 1
(1 2
)2 3
;3 4
try 
{ 
if 
( 
MessageQueue  
.  !
Exists! '
(' (
path( ,
), -
)- .
{ 
publicQueue 
=  !
new" %
MessageQueue& 2
(2 3
path3 7
)7 8
;8 9
publicQueue 
.  
Label  %
=& '
description( 3
;3 4
} 
else 
{ 
MessageQueue    
.    !
Create  ! '
(  ' (
path  ( ,
)  , -
;  - .
publicQueue!! 
=!!  !
new!!" %
MessageQueue!!& 2
(!!2 3
path!!3 7
)!!7 8
;!!8 9
publicQueue"" 
.""  
Label""  %
=""& '
description""( 3
;""3 4
}## 
publicQueue&& 
.&& 
	Formatter&& %
=&&& '
new&&( +
XmlMessageFormatter&&, ?
(&&? @
new&&@ C
Type&&D H
[&&H I
]&&I J
{'' 
typeof'' 
('' 
MessageObject'' )
)'') *
}''* +
)''+ ,
;'', -
while)) 
()) 
true)) 
))) 
{** 
Message-- 
msg-- 
=--  !
publicQueue--" -
.--- .
Receive--. 5
(--5 6
)--6 7
;--7 8
MessageObject.. !
	msgObject.." +
=.., -
(... /
MessageObject../ <
)..< =
msg..= @
...@ A
Body..A E
;..E F
Console11 
.11 
	WriteLine11 %
(11% &
	msgObject11& /
.11/ 0
ToString110 8
(118 9
)119 :
)11: ;
;11; <
if44 
(44 
!44 
users44 
.44 
Contains44 '
(44' (
	msgObject44( 1
.441 2
Username442 :
)44: ;
)44; <
{55 
users66 
.66 
Add66 !
(66! "
	msgObject66" +
.66+ ,
Username66, 4
)664 5
;665 6
}77 
switch99 
(99 
	msgObject99 %
.99% &
Command99& -
)99- .
{:: 
case<< 
Command<< $
.<<$ %
Shout<<% *
:<<* +
foreach== #
(==$ %
string==% +
user==, 0
in==1 3
users==4 9
)==9 :
{>> 
if??  "
(??" #
!??# $
(??$ %
user??% )
==??* ,
	msgObject??- 6
.??6 7
Username??7 ?
)??? @
)??@ A
Send@@  $
(@@$ %
user@@% )
,@@) *
	msgObject@@+ 4
)@@4 5
;@@5 6
}AA 
breakBB !
;BB! "
caseEE 
CommandEE $
.EE$ %
WhisperEE% ,
:EE, -
ifFF 
(FF  
!FF  !
usersFF! &
.FF& '
ContainsFF' /
(FF/ 0
	msgObjectFF0 9
.FF9 :

ToUsernameFF: D
)FFD E
)FFE F
{GG 
MessageObjectHH  -
newMsgHH. 4
=HH5 6
newHH7 :
MessageObjectHH; H
(HHH I
)HHI J
;HHJ K
newMsgII  &
.II& '
UsernameII' /
=II0 1
$strII2 :
;II: ;
newMsgJJ  &
.JJ& '
MessageJJ' .
=JJ/ 0
$strJJ1 E
+JJF G
	msgObjectJJH Q
.JJQ R

ToUsernameJJR \
+JJ] ^
$strJJ_ h
;JJh i
newMsgKK  &
.KK& '
CommandKK' .
=KK/ 0
CommandKK1 8
.KK8 9
SystemKK9 ?
;KK? @
SendLL  $
(LL$ %
	msgObjectLL% .
.LL. /
UsernameLL/ 7
,LL7 8
newMsgLL9 ?
)LL? @
;LL@ A
}MM 
elseNN  
{OO 
SendPP  $
(PP$ %
	msgObjectPP% .
.PP. /

ToUsernamePP/ 9
,PP9 :
	msgObjectPP; D
)PPD E
;PPE F
}QQ 
breakRR !
;RR! "
caseUU 
CommandUU $
.UU$ %
UsersUU% *
:UU* +
stringVV "
userListVV# +
=VV, -
StringVV. 4
.VV4 5
JoinVV5 9
(VV9 :
$strVV: =
,VV= >
usersVV? D
)VVD E
;VVE F
MessageObjectWW )
userMsgWW* 1
=WW2 3
newWW4 7
MessageObjectWW8 E
(WWE F
)WWF G
;WWG H
userMsgXX #
.XX# $
UsernameXX$ ,
=XX- .
$strXX/ 7
;XX7 8
userMsgYY #
.YY# $
MessageYY$ +
=YY, -
userListYY. 6
;YY6 7
userMsgZZ #
.ZZ# $
CommandZZ$ +
=ZZ, -
CommandZZ. 5
.ZZ5 6
UsersZZ6 ;
;ZZ; <
Send[[  
([[  !
	msgObject[[! *
.[[* +
Username[[+ 3
,[[3 4
userMsg[[5 <
)[[< =
;[[= >
break\\ !
;\\! "
}]] 
}^^ 
}__ 
catch`` 
{aa 
throwbb 
;bb 
}cc 
finallydd 
{ee 
publicQueuejj 
.jj 
Disposejj #
(jj# $
)jj$ %
;jj% &
}kk 
}ll 	
privatess 
staticss 
voidss 
Sendss  
(ss  !
stringss! '
	queueNamess( 1
,ss1 2
MessageObjectss3 @
msgssA D
)ssD E
{tt 	
stringuu 
pathuu 
=uu 
$struu (
+uu) *
	queueNameuu+ 4
;uu4 5
MessageQueueww 
queueww 
=ww  
nullww! %
;ww% &
ifzz 
(zz 
MessageQueuezz 
.zz 
Existszz #
(zz# $
pathzz$ (
)zz( )
)zz) *
{{{ 
queue|| 
=|| 
new|| 
MessageQueue|| (
(||( )
path||) -
)||- .
;||. /
queue}} 
.}} 
Label}} 
=}} 
$str}} 1
+}}2 3
	queueName}}4 =
;}}= >
}~~ 
else 
{
ÄÄ 
MessageQueue
ÅÅ 
.
ÅÅ 
Create
ÅÅ #
(
ÅÅ# $
path
ÅÅ$ (
)
ÅÅ( )
;
ÅÅ) *
queue
ÇÇ 
=
ÇÇ 
new
ÇÇ 
MessageQueue
ÇÇ (
(
ÇÇ( )
path
ÇÇ) -
)
ÇÇ- .
;
ÇÇ. /
queue
ÉÉ 
.
ÉÉ 
Label
ÉÉ 
=
ÉÉ 
$str
ÉÉ 1
+
ÉÉ2 3
	queueName
ÉÉ4 =
;
ÉÉ= >
}
ÑÑ 
Console
áá 
.
áá 
	WriteLine
áá 
(
áá 
$str
áá *
)
áá* +
;
áá+ ,
Console
àà 
.
àà 
	WriteLine
àà 
(
àà 
msg
àà !
.
àà! "
ToString
àà" *
(
àà* +
)
àà+ ,
)
àà, -
;
àà- .
queue
ää 
.
ää 
Send
ää 
(
ää 
msg
ää 
)
ää 
;
ää 
}
ãã 	
}
åå 
}çç à
]c:\Users\jafu\Source\Repos\NewRepo\MSMQTutorial\MSMQTutorialServer\Properties\AssemblyInfo.cs
[ 
assembly 	
:	 

AssemblyTitle 
( 
$str -
)- .
]. /
[		 
assembly		 	
:			 

AssemblyDescription		 
(		 
$str		 !
)		! "
]		" #
[

 
assembly

 	
:

	 
!
AssemblyConfiguration

  
(

  !
$str

! #
)

# $
]

$ %
[ 
assembly 	
:	 

AssemblyCompany 
( 
$str 
) 
] 
[ 
assembly 	
:	 

AssemblyProduct 
( 
$str /
)/ 0
]0 1
[ 
assembly 	
:	 

AssemblyCopyright 
( 
$str 0
)0 1
]1 2
[ 
assembly 	
:	 

AssemblyTrademark 
( 
$str 
)  
]  !
[ 
assembly 	
:	 

AssemblyCulture 
( 
$str 
) 
] 
[ 
assembly 	
:	 


ComVisible 
( 
false 
) 
] 
[ 
assembly 	
:	 

Guid 
( 
$str 6
)6 7
]7 8
[## 
assembly## 	
:##	 

AssemblyVersion## 
(## 
$str## $
)##$ %
]##% &
[$$ 
assembly$$ 	
:$$	 

AssemblyFileVersion$$ 
($$ 
$str$$ (
)$$( )
]$$) *